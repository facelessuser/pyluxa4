



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A library/command line tool for controlling Luxafor devices.">
      
      
        <link rel="canonical" href="https://facelessuser.github.io/pyluxa4/usage/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Usage - Pyluxa4</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra-30d8e6755c.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#usage" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://facelessuser.github.io/pyluxa4" title="Pyluxa4" class="md-header-nav__button md-logo">
          
            <i class="md-icon">description</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Pyluxa4
            </span>
            <span class="md-header-nav__topic">
              
                Usage
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/facelessuser/pyluxa4/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href=".." class="md-tabs__link md-tabs__link--active">
          Usage
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../about/contributing/" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://facelessuser.github.io/pyluxa4" title="Pyluxa4" class="md-nav__button md-logo">
      
        <i class="md-icon">description</i>
      
    </a>
    Pyluxa4
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/facelessuser/pyluxa4/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="Pyluxa4" class="md-nav__link">
      Pyluxa4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Usage
      </label>
    
    <a href="./" title="Usage" class="md-nav__link md-nav__link--active">
      Usage
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-the-server" class="md-nav__link">
    Starting the Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#killing-a-server" class="md-nav__link">
    Killing a Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-commands" class="md-nav__link">
    Sending Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduling-commands" class="md-nav__link">
    Scheduling Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-timers" class="md-nav__link">
    Setting Timers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-https" class="md-nav__link">
    Enabling HTTPS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-authentication" class="md-nav__link">
    Token Authentication
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usb/" title="USB API" class="md-nav__link">
      USB API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rest/" title="REST API" class="md-nav__link">
      REST API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../about/contributing/" title="Contributing & Support" class="md-nav__link">
      Contributing &amp; Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/development/" title="Development" class="md-nav__link">
      Development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-the-server" class="md-nav__link">
    Starting the Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#killing-a-server" class="md-nav__link">
    Killing a Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-commands" class="md-nav__link">
    Sending Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduling-commands" class="md-nav__link">
    Scheduling Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-timers" class="md-nav__link">
    Setting Timers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-https" class="md-nav__link">
    Enabling HTTPS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-authentication" class="md-nav__link">
    Token Authentication
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/facelessuser/pyluxa4/tree/master/docs/src/markdown/usage.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link"></a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link"></a></h2>
<p><code>pyluxa4</code> is mainly designed to be used from command line. When installed, it provides a command line tool called
<code>pyluxa4</code>. When installing the module, a tool will be added called <code>pyluxa4</code>. Assuming your Python installation's
bin/Script folder is added to your system's path, you will be able to access it from the command line:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 --version
pyluxa4 1.5
</pre></div>

<p>You can also access it via:</p>
<div class="codehilite"><pre><span></span>$ python3 -m pyluxa4 --version
pyluxa4 1.5
</pre></div>

<h2 id="starting-the-server">Starting the Server<a class="headerlink" href="#starting-the-server" title="Permanent link"></a></h2>
<p>Generally, <code>pyluxa4</code> is designed to be used by running a server, and then executing commands:</p>
<ol>
<li>
<p>Start the server:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 serve
[2019-09-21 15:21:49] INFO: Starting Luxafor server...
</pre></div>

</li>
<li>
<p>Run a command:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 api
{&#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/version&#39;, &#39;status&#39;: &#39;success&#39;, &#39;version&#39;: &#39;1.5.1&#39;, &#39;version_path&#39;: &#39;/pyluxa4/api/v1.5&#39;}
</pre></div>

</li>
</ol>
<p>If you have multiple devices connected, and you want to specify a specific one, you can run the <code>list</code> command to see
the connected devices. Devices are listed in the form <code>index&gt; path</code>.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 list
0&gt; \\?\hid#vid_04d8&amp;pid_f372#6&amp;38a95344&amp;1&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}
</pre></div>

<p>Then we can then specify from the command line which device to use when we start the server. Using the index, it would
be:</p>
<div class="codehilite"><pre><span></span>pyluxa4 serve --device-index 0
</pre></div>

<p>Using the path, it would be:</p>
<div class="codehilite"><pre><span></span>pyluxa4 serve --device-path &quot;\\?\hid#vid_04d8&amp;pid_f372#6&amp;38a95344&amp;1&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}&quot;
</pre></div>

<h2 id="killing-a-server">Killing a Server<a class="headerlink" href="#killing-a-server" title="Permanent link"></a></h2>
<p>If the server is running in a console, you can always press <span class="keys"><kbd class="key-control">Ctrl</kbd><span>＋</span><kbd class="key-c">C</kbd></span>, but if your server is running in the background,
you can kill the server with the <code>kill</code> command.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 kill
</pre></div>

<h2 id="sending-commands">Sending Commands<a class="headerlink" href="#sending-commands" title="Permanent link"></a></h2>
<p>Once the server is up and running, you can send a variety of commands to set the LEDs to a specific color, to fade
colors in or out, to strobe colors, to apply a wave effect to a color, or to simply run one of the built-in patterns.</p>
<p>More advanced commands are also available. The <code>scheduler</code> command can send JSON content to the server with a list of
commands to run at different times. The <code>timer</code> command can initiate a timer to initiate a command after a set amount of
time.</p>
<p>To run the commands, simply call <code>pyluxa4</code> with the command, followed by the commands arguments:</p>
<p>To set a color, simply specify the <code>color</code> command with the desired color:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 color red
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/color&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<p>There are a variety of commands, check out <a href="../commands/">Commands</a> to learn more.</p>
<h2 id="scheduling-commands">Scheduling Commands<a class="headerlink" href="#scheduling-commands" title="Permanent link"></a></h2>
<p><code>pyluxa4</code> provides a command scheduler that allows you to specify a number of commands to run at different times.</p>
<p>For instance, if you wanted to automatically turn your light red at 3:00 PM for an hour, then turn it back green at
4:00 PM, we could construct a couple of scheduled events. Schedules are done as JSON files, the file should contain a
list of events where each event is a hash of key value pairs that describes the event:</p>
<div class="codehilite"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;cmd&quot;</span><span class="o">:</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
    <span class="s2">&quot;days&quot;</span><span class="o">:</span> <span class="s2">&quot;wkd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;times&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;15:00&#39;</span><span class="p">],</span>
    <span class="s2">&quot;args&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;red&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;cmd&quot;</span><span class="o">:</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
    <span class="s2">&quot;days&quot;</span><span class="o">:</span> <span class="s2">&quot;wkd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;times&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;16:00&#39;</span><span class="p">],</span>
    <span class="s2">&quot;args&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;green&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>

<p>Then we can send the command to the server:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 scheduler --schedule myschedule.json
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/scheduler&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<p>If we want to clear existing scheduling events while sending our new schedule, simply add the <code>--clear</code> command.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 scheduler --schedule myschedule.json --clear
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/scheduler&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<p>If desired, you can also just run <code>--clear</code> without a schedule remove all scheduled events.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 scheduler --clear
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/scheduler&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<p>To get an output of loaded events in the schedule (timers not included), we can run:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 get schedule
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/scheduler/schedule&#39;, &#39;schedule&#39;: [{&#39;args&#39;: {&#39;color&#39;: &#39;red&#39;}, &#39;cmd&#39;: &#39;color&#39;, &#39;days&#39;: [&#39;wkd&#39;], &#39;times&#39;: [&#39;15:00&#39;]}, {&#39;args&#39;: {&#39;color&#39;: &#39;green&#39;}, &#39;cmd&#39;: &#39;color&#39;, &#39;days&#39;: [&#39;wkd&#39;], &#39;times&#39;: [&#39;16:00&#39;]}], &#39;status&#39;: &#39;success&#39;}
</pre></div>

<table>
<thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cmd</code></td>
<td>Name of the command to run</td>
</tr>
<tr>
<td><code>days</code></td>
<td>A list of days: <code>mon</code>, <code>tue</code>, <code>wed</code>, <code>thu</code>, <code>fri</code>, <code>sat</code>, or <code>sun</code>. You can also specify <code>wkd</code> for weekdays, <code>wke</code> for the weekend, and <code>all</code> for all days.</td>
</tr>
<tr>
<td><code>times</code></td>
<td>A list of times that the even will be run on. Times are specified as 24 hour time format.</td>
</tr>
<tr>
<td><code>args</code></td>
<td>Is a hash of key value pairs of arguments to pass the the specified command.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Sending Schedule on Server Start</p>
<p>You can also load a schedule while starting the server via the <code>--schedule</code> parameter:</p>
<div class="codehilite"><pre><span></span>pyluxa4 serve --schedule myschedule.json
[2019-09-22 14:05:10] INFO: Starting Luxafor server...
</pre></div>

</div>
<h2 id="setting-timers">Setting Timers<a class="headerlink" href="#setting-timers" title="Permanent link"></a></h2>
<p><code>pyluxa4</code> allows for setting timers. Timers are essentially a special kind of scheduled event. One that ignores <code>days</code>
and will destroy itself after the number of specified cycles has run to completion (unless it specified to run forever).</p>
<p>Additionally, timers are unique as the <code>times</code> list does not contain specific times, but contains relative times in the
form <code>&lt;number of hours&gt;:&lt;number of minutes&gt;</code>. For instance, if we wanted to have the timer go off in 3 hours and
30 minutes, we would specify the time as <code>3:30</code>. This does <strong>not</strong> represent <code>3:30 AM</code>, but 3 hours and 30 minutes
from the time the timer was added.</p>
<p>For instance, if we wanted to strobe a red light in an hour and 30 minutes, we could use the following command:</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 1:30
</pre></div>

<p>If we wanted to do it at ten minutes from now followed by another 5 minutes after that:</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 0:10,0:5
</pre></div>

<p>We could even repeat the cycle to flash to iterate through the timers twice, essentially flashing the red light at
10 minutes, 5 minutes, 10 minutes, and 5 minutes</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 0:10,0:5 --cycle 2
</pre></div>

<p>We could even do it continuously every 30 minutes by specifying the cycle as 0 (meaning forever):</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 0:30 --cycle 0
</pre></div>

<p>You can also delay when the times start by specifying a specific time to wait for before starting the timer. For
instance, here we start flashing the light every 30 minutes starting at 9:00 AM:</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 0:30 --cycle 0 --start 9:00
</pre></div>

<p>You could also terminate a timer after at a specific time, for example 5:00 PM:</p>
<div class="codehilite"><pre><span></span>pyluxa4 timer --cmd strobe --color red --speed 10 --repeat 10 --times 0:30 --cycle 0 --start 9:00 --end 17:00
</pre></div>

<p>As mentioned, times are just a special kind of scheduled event, you can actually put them in a schedule file and they
will be recognized. You <em>must</em> add <code>timer</code> with the number of times to cycle through the timers. You also <em>must</em> make
times relative. The key <code>days</code> will be ignored in timers and can be omitted. You can also use two one or both timer
specific keys (<code>start</code> and <code>end</code>) to specify a respective start and end time for the timers.</p>
<p>For a simple example of a timer represented in a schedule file, consider a case where we'd like to turn off lights as
soon as a schedule is loaded. We could specify a timer with a relative time of <code>0:0</code>, which means right away:</p>
<div class="codehilite"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
      <span class="s2">&quot;cmd&quot;</span><span class="o">:</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span>
      <span class="s2">&quot;timer&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;times&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;0:0&quot;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>

<p>You can clear all running timers by calling the <code>scheduler</code> command with the <code>--cancel</code> parameter:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 scheduler --cancel
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/scheduler&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<p>To get an output of loaded timers, we can run:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 get timers
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/scheduler/timers&#39;, &#39;schedule&#39;: [{&#39;args&#39;: {}, &#39;cmd&#39;: &#39;off&#39;, &#39;days&#39;: &#39;all&#39;, &#39;end&#39;: None, &#39;start&#39;: None, &#39;timer&#39;: 1, &#39;times&#39;: [&#39;0:10&#39;]}], &#39;status&#39;: &#39;success&#39;}
</pre></div>

<h2 id="enabling-https">Enabling HTTPS<a class="headerlink" href="#enabling-https" title="Permanent link"></a></h2>
<p><code>pyluxa4</code> is mainly meant to be used on a local network, so these instructions are from that perspective.</p>
<p>In order to enable HTTPS, we need to have a certificate. In our local network case, using a simple self signed
certificate is more than sufficient.</p>
<p>To create a certificate, we will assume you have <a href="https://www.openssl.org/">OpenSSL</a> installed. If you are on Windows
using Git Bash, it will likely be available in your Bash terminal. We use OpenSSL to generate a x509v3 certificate. You
can create a simple configuration template like the one shown below which adds in the v3 parameters. Replace the IP with
the one from your machine. We will call this file <code>cert.conf</code>.</p>
<div class="codehilite"><pre><span></span><span class="k">[ req ]</span>
<span class="na">default_bits</span>               <span class="o">=</span> <span class="s">4096</span>
<span class="na">distinguished_name</span>         <span class="o">=</span> <span class="s">req_distinguished_name</span>
<span class="k">[ req_distinguished_name ]</span>
<span class="na">countryName</span>                <span class="o">=</span> <span class="s">Country Name (2 letter code)</span>
<span class="na">stateOrProvinceName</span>        <span class="o">=</span> <span class="s">State or Province Name (full name)</span>
<span class="na">localityName</span>               <span class="o">=</span> <span class="s">Locality Name (eg, city)</span>
<span class="na">organizationName</span>           <span class="o">=</span> <span class="s">Organization Name (eg, company)</span>
<span class="na">organizationalUnitName</span>     <span class="o">=</span> <span class="s">Organizational Unit Name (eg, section)</span>
<span class="na">commonName</span>                 <span class="o">=</span> <span class="s">Common Name (e.g. server FQDN or YOUR name)</span>
<span class="na">emailAddress</span>               <span class="o">=</span> <span class="s">Email Address</span>
<span class="k">[ v3_req  ]</span>
<span class="na">subjectAltName</span>             <span class="o">=</span> <span class="s">@alt_names</span>
<span class="k">[alt_names]</span>
<span class="na">DNS.1</span>                      <span class="o">=</span> <span class="s">localhost</span>
<span class="na">IP.1</span>                       <span class="o">=</span> <span class="s">127.0.0.1</span>
<span class="na">IP.2</span>                       <span class="o">=</span> <span class="s">192.168.1.2</span>
</pre></div>

<p>Afterwards, run the following command. Enter the information that you'd like:</p>
<div class="codehilite"><pre><span></span>openssl req -x509 -out pyluxa4.cer -newkey rsa:4096 -nodes -keyout private.key -extensions v3_req -days 3650 -config cert.conf
</pre></div>

<p>You should now have a certificate <code>pyluxa4.cer</code> and a private key file <code>private.key</code>.</p>
<p>Afterwards, you we can use the <code>--ssl-cert</code> and <code>--ssl-key</code> parameters to enable HTTPS in the server:</p>
<div class="codehilite"><pre><span></span>pyluxa4 serve --ssl-cert pyluxa4.cer --ssl-key private.key
</pre></div>

<p>Now the server will only accept commands over HTTPS.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 api
{&#39;status&#39;: &#39;fail&#39;, &#39;code&#39;: 0, &#39;error&#39;: &#39;Server does not appear to be running&#39;}
</pre></div>

<p>To send commands with over HTTPS to the server, simply use the <code>--secure</code> parameter. If you send the command with <code>0</code>,
it will ignore verifying the certificate:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 api --secure 0
c:\Python36\lib\site-packages\urllib3\connectionpool.py:851: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  InsecureRequestWarning)
{&#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/version&#39;, &#39;status&#39;: &#39;success&#39;, &#39;version&#39;: &#39;1.5.1&#39;, &#39;version_path&#39;: &#39;/pyluxa4/api/v1.5&#39;}
</pre></div>

<p>If you provide the certificate instead, it will verify the certificate:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 api --secure pyluxa4.cer
{&#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/version&#39;, &#39;status&#39;: &#39;success&#39;, &#39;version&#39;: &#39;1.5.1&#39;, &#39;version_path&#39;: &#39;/pyluxa4/api/v1.5&#39;}
</pre></div>

<h2 id="token-authentication">Token Authentication<a class="headerlink" href="#token-authentication" title="Permanent link"></a></h2>
<p>In addition to using SSL for HTTPS, using token authentication can help make it more difficult for anyone to send
commands to your Luxafor device. Tokens should really only be used with SSL.</p>
<p>Simply specify your desired token using the the <code>--token</code> parameter when initiating the server:</p>
<div class="codehilite"><pre><span></span>pyluxa4 serve --ssl-cert pyluxa4.cer --ssl-key private.key --token secret
</pre></div>

<p>Now the server will reject commands that require authentication if they are sent without the token.</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 color red --secure pyluxa4.cer
{&#39;status&#39;: &#39;fail&#39;, &#39;code&#39;: 401, &#39;error&#39;: &#39;Unauthorized Access&#39;}
</pre></div>

<p>But when we provide the token, the command passes:</p>
<div class="codehilite"><pre><span></span>$ pyluxa4 color red --secure pyluxa4.cer --token secret
{&#39;code&#39;: 200, &#39;error&#39;: &#39;&#39;, &#39;path&#39;: &#39;/pyluxa4/api/v1.5/command/color&#39;, &#39;status&#39;: &#39;success&#39;}
</pre></div>

<div class="admonition note">
<p class="admonition-title">Commands that Don't Require Authentication</p>
<p><code>api</code> is the one command that does not require authentication. It will accept commands with or without tokens.</p>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../install/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="../commands/" title="Commands" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Commands
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 <a href="https://github.com/facelessuser">Isaac Muse</a>
<br><span class="md-footer-custom-text">emoji provided free by <a href="http://www.emojione.com">EmojiOne</a></span>

          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/facelessuser" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../extra-0b9b22dd13.js"></script>
      
    
  </body>
</html>